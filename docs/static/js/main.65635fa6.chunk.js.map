{"version":3,"sources":["components/Slider.js","utils/draw.js","utils/download.js","App.js","index.js"],"names":["Slider","props","className","type","max","min","step","value","onInput","e","change","Draw","options","this","canvas","document","getElementById","element","ctx","getContext","painting","lastPoint","x","undefined","y","clear","history","lineWidth","width","body","clientWidth","height","clientHeight","onmousedown","readyDraw","onmousemove","drawing","onmouseup","stopDraw","firstDot","getImageData","saveData","offsetX","offsetY","save","drawCircle","newPoint","drawLine","radius","beginPath","arc","Math","PI","fill","clip","clearRect","restore","x1","y1","x2","y2","lineCap","lineJoin","globalCompositeOperation","stroke","moveTo","lineTo","closePath","length","putImageData","pop","data","shift","push","_userAgent","navigator","userAgent","toLowerCase","isChrome","indexOf","isSafari","isFireFox","isIE","window","ActiveXObject","console","log","downloadBase64Img","download","name","imgData","downloadFile","fileName","content","aLink","createElement","blob","base64ToBlob","createEvent","initEvent","href","URL","createObjectURL","click","code","parts","split","contentType","raw","atob","rawLength","uInt8Array","Uint8Array","i","charCodeAt","Blob","App","draw","state","SliderValue","init","setState","target","changeLine","img","toDataURL","id","onClick","checkPen","cleaning","undo","reset","sliderChange","React","Component","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.65635fa6.chunk.js","sourcesContent":["import \"./Slider.css\"\r\n\r\nexport function Slider(props) {\r\n    return (\r\n        <div>\r\n            <input\r\n                className=\"slider\"\r\n                type=\"range\"\r\n                max={props.max}\r\n                min={props.min}\r\n                step=\"1\"\r\n                value={props.value}\r\n                onInput={(e) => props.change(e)}\r\n            />\r\n            <p className=\"title\">\r\n                <span>小</span>\r\n                <span>大</span>\r\n            </p>\r\n        </div>\r\n    )\r\n}\r\n","export class Draw {\r\n    constructor(options) {\r\n        // 获取canvas实例\r\n        this.canvas = document.getElementById(options.element);\r\n        this.ctx = this.canvas.getContext(\"2d\");\r\n        // 初始化画笔\r\n        this.painting = false;\r\n        this.lastPoint = {x: undefined, y: undefined};\r\n        this.clear = false; //是否亲清除\r\n        this.history = []; // 记录\r\n        this.lineWidth = 3; // 笔刷大小\r\n    }\r\n    // 初始化\r\n    init() {\r\n        this.canvas.width = document.body.clientWidth - 10;\r\n        this.canvas.height = document.body.clientHeight - 10;\r\n        this.canvas.onmousedown = e => {\r\n            this.readyDraw(e);\r\n        };\r\n        this.canvas.onmousemove = e => {\r\n            this.drawing(e);\r\n        };\r\n        this.canvas.onmouseup = () => {\r\n            this.stopDraw();\r\n        };\r\n    }\r\n    // 开始准备绘制\r\n    readyDraw(e) {\r\n        let firstDot = this.ctx.getImageData(\r\n            0,\r\n            0,\r\n            this.canvas.width,\r\n            this.canvas.height\r\n        ); //在这里储存绘图表面\r\n        this.saveData(firstDot);\r\n        this.painting = true;\r\n        let x = e.offsetX;\r\n        let y = e.offsetY;\r\n        this.lastPoint = {x: x, y: y};\r\n        this.ctx.save();\r\n        this.drawCircle(x, y, 0);\r\n    }\r\n    // 鼠标点击canvas正在绘画\r\n    drawing(e) {\r\n        if (this.painting) {\r\n            let x = e.offsetX;\r\n            let y = e.offsetY;\r\n            let newPoint = {x: x, y: y};\r\n            this.drawLine(this.lastPoint.x, this.lastPoint.y, newPoint.x, newPoint.y);\r\n            this.lastPoint = newPoint;\r\n        }\r\n    }\r\n    // 停止绘制\r\n    stopDraw() {\r\n        this.painting = false;\r\n    }\r\n    // 鼠标点击画点\r\n    drawCircle(x, y, radius) {\r\n        this.ctx.save();\r\n        this.ctx.beginPath();\r\n        this.ctx.arc(x, y, radius, 0, Math.PI * 2);\r\n        this.ctx.fill();\r\n        if (this.clear) {\r\n            this.ctx.clip();\r\n            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n            this.ctx.restore();\r\n        }\r\n    }\r\n    // 鼠标平移划线\r\n    drawLine(x1, y1, x2, y2) {\r\n        this.ctx.lineWidth = this.lineWidth; // 笔刷大小\r\n        this.ctx.lineCap = \"round\";\r\n        this.ctx.lineJoin = \"round\";\r\n        if (this.clear) {\r\n            this.ctx.save();\r\n            this.ctx.globalCompositeOperation = \"destination-out\";\r\n            this.ctx.stroke();\r\n            this.ctx.moveTo(x1, y1);\r\n            this.ctx.lineTo(x2, y2);\r\n            this.ctx.closePath();\r\n            this.ctx.clip();\r\n            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n            this.ctx.restore();\r\n        } else {\r\n            this.ctx.moveTo(x1, y1);\r\n            this.ctx.lineTo(x2, y2);\r\n            this.ctx.stroke();\r\n            this.ctx.closePath();\r\n        }\r\n    }\r\n    // 清除\r\n    cleaning() {\r\n        this.clear = true;\r\n    }\r\n    // 清空\r\n    reset() {\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n    // 撤销\r\n    undo() {\r\n        if (this.history.length < 1) return false;\r\n        this.ctx.putImageData(this.history[this.history.length - 1], 0, 0);\r\n        this.history.pop();\r\n    }\r\n    // 自动保存每一步,上限为储存10步，太多了怕挂掉\r\n    saveData(data) {\r\n        this.history.length === 10 && this.history.shift();\r\n        this.history.push(data);\r\n    }\r\n    // 切换画笔的宽度\r\n    changeLine(value) {\r\n        this.lineWidth = value;\r\n    }\r\n    // 选择画笔\r\n    checkPen() {\r\n        this.clear = false;\r\n    }\r\n}\r\n","const _userAgent = navigator.userAgent.toLowerCase();\r\nconst isChrome = _userAgent.indexOf(\"chrome\") > -1;\r\nconst isSafari = _userAgent.indexOf(\"safari\") > -1;\r\nconst isFireFox = _userAgent.indexOf(\"firefox\") > -1;\r\n// @ts-ignore\r\nconst isIE = !!window.ActiveXObject || \"ActiveXObject\" in window;\r\n\r\nconsole.log(_userAgent, isChrome, isSafari, isFireFox, isIE);\r\nexport const downloadFile = sUrl => {\r\n    console.log(sUrl);\r\n    if (/(iP)/g.test(navigator.userAgent)) {\r\n        return false;\r\n    }\r\n\r\n    if (isChrome || isSafari || isFireFox) {\r\n        let link = document.createElement(\"a\");\r\n        link.href = sUrl;\r\n        if (link.download !== undefined) {\r\n            link.download = sUrl.substring(sUrl.lastIndexOf(\"/\") + 1, sUrl.length);\r\n        }\r\n\r\n        if (document.createEvent) {\r\n            let e = document.createEvent(\"MouseEvents\");\r\n            e.initEvent(\"click\", true, true);\r\n            link.dispatchEvent(e);\r\n            return true;\r\n        }\r\n    }\r\n\r\n    if (isIE) {\r\n        const iframe = document.createElement(\"iframe\");\r\n        iframe.src = sUrl;\r\n        iframe.id = \"saveFileFrame\";\r\n        iframe.style.display = \"none\";\r\n        iframe.onload = function () {\r\n            document.frames[\"saveFileFrame\"].document.execCommand(\"saveAs\");\r\n            iframe.removeNode(true);\r\n        };\r\n        document.body.appendChild(iframe);\r\n        return true;\r\n    }\r\n\r\n    if (sUrl.indexOf(\"?\") === -1) {\r\n        sUrl += \"?download\";\r\n    }\r\n\r\n    window.open(sUrl, \"_self\");\r\n    return true;\r\n};\r\n\r\nexport const downloadBase64Img = {\r\n    // 下载图片\r\n    download(name, imgData) {\r\n        // const imgData = 'base64---------' // 这里放需要下载的base64\r\n        this.downloadFile(name, imgData);\r\n    },\r\n    // 下载\r\n    downloadFile(fileName, content) {\r\n        const aLink = document.createElement(\"a\");\r\n        const blob = this.base64ToBlob(content); // new Blob([content]);\r\n\r\n        const evt = document.createEvent(\"HTMLEvents\");\r\n        evt.initEvent(\"click\", true, true); // initEvent 不加后两个参数在FF下会报错  事件类型，是否冒泡，是否阻止浏览器的默认行为\r\n        aLink.download = fileName;\r\n        aLink.href = URL.createObjectURL(blob);\r\n        aLink.click();\r\n    },\r\n    // base64转blob\r\n    base64ToBlob(code) {\r\n        const parts = code.split(\";base64,\");\r\n        const contentType = parts[0].split(\":\")[1];\r\n        const raw = window.atob(parts[1]);\r\n        const rawLength = raw.length;\r\n\r\n        const uInt8Array = new Uint8Array(rawLength);\r\n\r\n        for (let i = 0; i < rawLength; ++i) {\r\n            uInt8Array[i] = raw.charCodeAt(i);\r\n        }\r\n        return new Blob([uInt8Array], {type: contentType});\r\n    }\r\n};\r\n","import './App.css'\r\nimport {Slider} from \"./components/Slider\"\r\nimport {Draw} from \"./utils/draw\"\r\nimport {downloadBase64Img} from \"./utils/download\";\r\nimport React from \"react\"\r\n\r\nclass App extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.draw = \"\"\r\n        this.state = {\r\n            SliderValue: 2\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.draw = new Draw({element: 'draw'})\r\n        this.draw.init()\r\n    }\r\n\r\n    sliderChange(e) {\r\n        this.setState({SliderValue: e.target.value})\r\n        this.draw.changeLine(this.state.SliderValue)\r\n    }\r\n\r\n    download() {\r\n        const img = document.getElementById(\"draw\").toDataURL(\"image/png\");\r\n        downloadBase64Img.download(\"image\", img)\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"draw-content\">\r\n                <canvas id=\"draw\"/>\r\n                <div className=\"operating-btn-list\">\r\n                    <button onClick={() => this.download()}>下载</button>\r\n                    <button onClick={() => this.draw.checkPen()}>画笔</button>\r\n                    <button onClick={() => this.draw.cleaning()}>橡皮擦</button>\r\n                    <button onClick={() => this.draw.undo()}>撤销</button>\r\n                    <button onClick={() => this.draw.reset()}>重绘</button>\r\n                    <div className=\"range-set\">\r\n                        <Slider change={(e) => {\r\n                            this.sliderChange(e)\r\n                        }} max=\"12\" min=\"1\" value={this.state.SliderValue}/>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default App\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <App/>\r\n    </React.StrictMode>,\r\n    document.getElementById('root')\r\n);\r\n\r\n"],"sourceRoot":""}